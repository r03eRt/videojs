/*! @name videojs-playlist @version 4.2.3 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsPlaylist=t(e.videojs)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(e){var t=e.playlist.autoadvance_;t.timeout&&e.clearTimeout(t.timeout),t.trigger&&e.off("ended",t.trigger),t.timeout=null,t.trigger=null},r=function e(r,n){var i;(t(r),"number"==typeof(i=n)&&!isNaN(i)&&i>=0&&i<1/0)?(r.playlist.autoadvance_.delay=n,r.playlist.autoadvance_.trigger=function(){var i=function(){return e(r,n)};r.one("play",i),r.playlist.autoadvance_.timeout=r.setTimeout(function(){t(r),r.off("play",i),r.playlist.next()},1e3*n)},r.one("ended",r.playlist.autoadvance_.trigger)):r.playlist.autoadvance_.delay=null},n=function(e,t){var n=!e.paused()||e.ended();return e.trigger("beforeplaylistitem",t),e.poster(t.poster||""),e.src(t.sources),function(e){for(var t=e.remoteTextTracks(),r=t&&t.length||0;r--;)e.removeRemoteTextTrack(t[r])}(e),e.ready(function(){if((t.textTracks||[]).forEach(e.addRemoteTextTrack.bind(e)),e.trigger("playlistitem",t),n){var i=e.play();void 0!==i&&"function"==typeof i.then&&i.then(null,function(e){})}r(e,e.playlist.autoadvance_.delay)}),e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){for(var r=0;r<e.length;r++){var n=e[r].sources;if(Array.isArray(n))for(var o=0;o<n.length;o++){var a=n[o];if(a&&(c=void 0,s=void 0,c=u=a,s=l=t,"object"===(void 0===u?"undefined":i(u))&&(c=u.src),"object"===(void 0===l?"undefined":i(l))&&(s=l.src),/^\/\//.test(c)&&(s=s.slice(s.indexOf("//"))),/^\/\//.test(s)&&(c=c.slice(c.indexOf("//"))),c===s))return r}}var u,l,c,s;return-1},a=function(e){for(var t=-1,r=e.length-1;++t<e.length;){var n=t+Math.floor(Math.random()*(r-t+1)),i=e[n];e[n]=e[t],e[t]=i}return e};var u=function(i,u){!function(i,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=null,s=!1,f=i.playlist=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(s)throw new Error("do not call playlist() during a playlist change");if(Array.isArray(e)){var r=Array.isArray(c)?c.slice():null;c=e.slice(),s=!0,i.trigger({type:"duringplaylistchange",nextIndex:t,nextPlaylist:c,previousIndex:f.currentIndex_,previousPlaylist:r||[]}),s=!1,-1!==t&&f.currentItem(t),r&&i.setTimeout(function(){i.trigger("playlistchange")},0)}return c.slice()};i.on("loadstart",function(){-1===f.currentItem()&&t(i)}),f.currentIndex_=-1,f.player_=i,f.autoadvance_={},f.repeat_=!1,f.currentItem=function(e){return s?f.currentIndex_:("number"==typeof e&&f.currentIndex_!==e&&e>=0&&e<c.length?(f.currentIndex_=e,n(f.player_,c[f.currentIndex_])):f.currentIndex_=f.indexOf(f.player_.currentSrc()||""),f.currentIndex_)},f.contains=function(e){return-1!==f.indexOf(e)},f.indexOf=function(e){if("string"==typeof e)return o(c,e);for(var t=Array.isArray(e)?e:e.sources,r=0;r<t.length;r++){var n=t[r];if("string"==typeof n)return o(c,n);if(n.src)return o(c,n.src)}return-1},f.currentIndex=function(){return f.currentItem()},f.lastIndex=function(){return c.length-1},f.nextIndex=function(){var e=f.currentItem();if(-1===e)return-1;var t=f.lastIndex();return f.repeat_&&e===t?0:Math.min(e+1,t)},f.previousIndex=function(){var e=f.currentItem();return-1===e?-1:f.repeat_&&0===e?f.lastIndex():Math.max(e-1,0)},f.first=function(){if(!s)return c.length?c[f.currentItem(0)]:void(f.currentIndex_=-1)},f.last=function(){if(!s)return c.length?c[f.currentItem(f.lastIndex())]:void(f.currentIndex_=-1)},f.next=function(){if(!s){var e=f.nextIndex();return e!==f.currentIndex_?c[f.currentItem(e)]:void 0}},f.previous=function(){if(!s){var e=f.previousIndex();return e!==f.currentIndex_?c[f.currentItem(e)]:void 0}},f.autoadvance=function(e){r(f.player_,e)},f.repeat=function(t){return void 0===t?f.repeat_:"boolean"==typeof t?(f.repeat_=!!t,f.repeat_):void e.log.error("videojs-playlist: Invalid value for repeat",t)},f.sort=function(e){c.length&&(c.sort(e),s||i.trigger("playlistsorted"))},f.reverse=function(){c.length&&(c.reverse(),s||i.trigger("playlistsorted"))},f.shuffle=function(){var e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rest,r=0,n=c;(t&&(r=f.currentIndex_+1,n=c.slice(r)),n.length<=1)||(a(n),t&&(e=c).splice.apply(e,[r,n.length].concat(n)),s||i.trigger("playlistsorted"))},Array.isArray(u)?f(u.slice(),l):c=[]}(this,i,u)};return(e.registerPlugin||e.plugin)("playlist",u),u.VERSION="4.2.3",u});
